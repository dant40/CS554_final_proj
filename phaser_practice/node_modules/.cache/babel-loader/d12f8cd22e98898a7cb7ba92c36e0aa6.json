{"ast":null,"code":"/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2020 Photon Storm Ltd.\r\n * @license      {@link https://opensource.org/licenses/MIT|MIT License}\r\n */\nvar CanvasPool = require('../display/canvas/CanvasPool');\n/**\r\n * Determines the canvas features of the browser running this Phaser Game instance.\r\n * These values are read-only and populated during the boot sequence of the game.\r\n * They are then referenced by internal game systems and are available for you to access\r\n * via `this.sys.game.device.canvasFeatures` from within any Scene.\r\n * \r\n * @typedef {object} Phaser.Device.CanvasFeatures\r\n * @since 3.0.0\r\n * \r\n * @property {boolean} supportInverseAlpha - Set to true if the browser supports inversed alpha.\r\n * @property {boolean} supportNewBlendModes - Set to true if the browser supports new canvas blend modes.\r\n */\n\n\nvar CanvasFeatures = {\n  supportInverseAlpha: false,\n  supportNewBlendModes: false\n};\n\nfunction checkBlendMode() {\n  var pngHead = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/';\n  var pngEnd = 'AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==';\n  var magenta = new Image();\n\n  magenta.onload = function () {\n    var yellow = new Image();\n\n    yellow.onload = function () {\n      var canvas = CanvasPool.create(yellow, 6, 1);\n      var context = canvas.getContext('2d');\n      context.globalCompositeOperation = 'multiply';\n      context.drawImage(magenta, 0, 0);\n      context.drawImage(yellow, 2, 0);\n\n      if (!context.getImageData(2, 0, 1, 1)) {\n        return false;\n      }\n\n      var data = context.getImageData(2, 0, 1, 1).data;\n      CanvasPool.remove(yellow);\n      CanvasFeatures.supportNewBlendModes = data[0] === 255 && data[1] === 0 && data[2] === 0;\n    };\n\n    yellow.src = pngHead + '/wCKxvRF' + pngEnd;\n  };\n\n  magenta.src = pngHead + 'AP804Oa6' + pngEnd;\n  return false;\n}\n\nfunction checkInverseAlpha() {\n  var canvas = CanvasPool.create(this, 2, 1);\n  var context = canvas.getContext('2d');\n  context.fillStyle = 'rgba(10, 20, 30, 0.5)'; //  Draw a single pixel\n\n  context.fillRect(0, 0, 1, 1); //  Get the color values\n\n  var s1 = context.getImageData(0, 0, 1, 1);\n\n  if (s1 === null) {\n    return false;\n  } //  Plot them to x2\n\n\n  context.putImageData(s1, 1, 0); //  Get those values\n\n  var s2 = context.getImageData(1, 0, 1, 1); //  Compare and return\n\n  return s2.data[0] === s1.data[0] && s2.data[1] === s1.data[1] && s2.data[2] === s1.data[2] && s2.data[3] === s1.data[3];\n}\n\nfunction init() {\n  if (document !== undefined) {\n    CanvasFeatures.supportNewBlendModes = checkBlendMode();\n    CanvasFeatures.supportInverseAlpha = checkInverseAlpha();\n  }\n\n  return CanvasFeatures;\n}\n\nmodule.exports = init();","map":{"version":3,"sources":["/mnt/c/Users/kubec/Desktop/Projects/Projects/Phaser/phaser_practice/node_modules/phaser/src/device/CanvasFeatures.js"],"names":["CanvasPool","require","CanvasFeatures","supportInverseAlpha","supportNewBlendModes","checkBlendMode","pngHead","pngEnd","magenta","Image","onload","yellow","canvas","create","context","getContext","globalCompositeOperation","drawImage","getImageData","data","remove","src","checkInverseAlpha","fillStyle","fillRect","s1","putImageData","s2","init","document","undefined","module","exports"],"mappings":"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","sourcesContent":["/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2020 Photon Storm Ltd.\r\n * @license      {@link https://opensource.org/licenses/MIT|MIT License}\r\n */\r\n\r\nvar CanvasPool = require('../display/canvas/CanvasPool');\r\n\r\n/**\r\n * Determines the canvas features of the browser running this Phaser Game instance.\r\n * These values are read-only and populated during the boot sequence of the game.\r\n * They are then referenced by internal game systems and are available for you to access\r\n * via `this.sys.game.device.canvasFeatures` from within any Scene.\r\n * \r\n * @typedef {object} Phaser.Device.CanvasFeatures\r\n * @since 3.0.0\r\n * \r\n * @property {boolean} supportInverseAlpha - Set to true if the browser supports inversed alpha.\r\n * @property {boolean} supportNewBlendModes - Set to true if the browser supports new canvas blend modes.\r\n */\r\nvar CanvasFeatures = {\r\n\r\n    supportInverseAlpha: false,\r\n    supportNewBlendModes: false\r\n\r\n};\r\n\r\nfunction checkBlendMode ()\r\n{\r\n    var pngHead = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/';\r\n    var pngEnd = 'AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==';\r\n\r\n    var magenta = new Image();\r\n\r\n    magenta.onload = function ()\r\n    {\r\n        var yellow = new Image();\r\n\r\n        yellow.onload = function ()\r\n        {\r\n            var canvas = CanvasPool.create(yellow, 6, 1);\r\n            var context = canvas.getContext('2d');\r\n\r\n            context.globalCompositeOperation = 'multiply';\r\n\r\n            context.drawImage(magenta, 0, 0);\r\n            context.drawImage(yellow, 2, 0);\r\n\r\n            if (!context.getImageData(2, 0, 1, 1))\r\n            {\r\n                return false;\r\n            }\r\n\r\n            var data = context.getImageData(2, 0, 1, 1).data;\r\n\r\n            CanvasPool.remove(yellow);\r\n\r\n            CanvasFeatures.supportNewBlendModes = (data[0] === 255 && data[1] === 0 && data[2] === 0);\r\n        };\r\n\r\n        yellow.src = pngHead + '/wCKxvRF' + pngEnd;\r\n    };\r\n\r\n    magenta.src = pngHead + 'AP804Oa6' + pngEnd;\r\n\r\n    return false;\r\n}\r\n\r\nfunction checkInverseAlpha ()\r\n{\r\n    var canvas = CanvasPool.create(this, 2, 1);\r\n    var context = canvas.getContext('2d');\r\n\r\n    context.fillStyle = 'rgba(10, 20, 30, 0.5)';\r\n\r\n    //  Draw a single pixel\r\n    context.fillRect(0, 0, 1, 1);\r\n\r\n    //  Get the color values\r\n    var s1 = context.getImageData(0, 0, 1, 1);\r\n\r\n    if (s1 === null)\r\n    {\r\n        return false;\r\n    }\r\n\r\n    //  Plot them to x2\r\n    context.putImageData(s1, 1, 0);\r\n\r\n    //  Get those values\r\n    var s2 = context.getImageData(1, 0, 1, 1);\r\n\r\n    //  Compare and return\r\n    return (s2.data[0] === s1.data[0] && s2.data[1] === s1.data[1] && s2.data[2] === s1.data[2] && s2.data[3] === s1.data[3]);\r\n}\r\n\r\nfunction init ()\r\n{\r\n    if (document !== undefined)\r\n    {\r\n        CanvasFeatures.supportNewBlendModes = checkBlendMode();\r\n        CanvasFeatures.supportInverseAlpha = checkInverseAlpha();\r\n    }\r\n\r\n    return CanvasFeatures;\r\n}\r\n\r\nmodule.exports = init();\r\n"]},"metadata":{},"sourceType":"script"}