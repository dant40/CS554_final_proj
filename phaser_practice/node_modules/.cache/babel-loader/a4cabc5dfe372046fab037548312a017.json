{"ast":null,"code":"/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2020 Photon Storm Ltd.\r\n * @license      {@link https://opensource.org/licenses/MIT|MIT License}\r\n */\n\n/**\r\n * [description]\r\n *\r\n * @function Phaser.Physics.Impact.SeparateY\r\n * @since 3.0.0\r\n *\r\n * @param {Phaser.Physics.Impact.World} world - [description]\r\n * @param {Phaser.Physics.Impact.Body} top - [description]\r\n * @param {Phaser.Physics.Impact.Body} bottom - [description]\r\n * @param {Phaser.Physics.Impact.Body} [weak] - [description]\r\n */\nvar SeparateY = function (world, top, bottom, weak) {\n  var nudge = top.pos.y + top.size.y - bottom.pos.y;\n  var nudgeX;\n  var resTop;\n\n  if (weak) {\n    var strong = top === weak ? bottom : top;\n    weak.vel.y = -weak.vel.y * weak.bounciness + strong.vel.y; // Riding on a platform?\n\n    nudgeX = 0;\n\n    if (weak === top && Math.abs(weak.vel.y - strong.vel.y) < weak.minBounceVelocity) {\n      weak.standing = true;\n      nudgeX = strong.vel.x * world.delta;\n    }\n\n    var resWeak = world.collisionMap.trace(weak.pos.x, weak.pos.y, nudgeX, weak === top ? -nudge : nudge, weak.size.x, weak.size.y);\n    weak.pos.y = resWeak.pos.y;\n    weak.pos.x = resWeak.pos.x;\n  } else if (world.gravity && (bottom.standing || top.vel.y > 0)) {\n    resTop = world.collisionMap.trace(top.pos.x, top.pos.y, 0, -(top.pos.y + top.size.y - bottom.pos.y), top.size.x, top.size.y);\n    top.pos.y = resTop.pos.y;\n\n    if (top.bounciness > 0 && top.vel.y > top.minBounceVelocity) {\n      top.vel.y *= -top.bounciness;\n    } else {\n      top.standing = true;\n      top.vel.y = 0;\n    }\n  } else {\n    var v2 = (top.vel.y - bottom.vel.y) / 2;\n    top.vel.y = -v2;\n    bottom.vel.y = v2;\n    nudgeX = bottom.vel.x * world.delta;\n    resTop = world.collisionMap.trace(top.pos.x, top.pos.y, nudgeX, -nudge / 2, top.size.x, top.size.y);\n    top.pos.y = resTop.pos.y;\n    var resBottom = world.collisionMap.trace(bottom.pos.x, bottom.pos.y, 0, nudge / 2, bottom.size.x, bottom.size.y);\n    bottom.pos.y = resBottom.pos.y;\n  }\n};\n\nmodule.exports = SeparateY;","map":{"version":3,"sources":["/mnt/c/Users/kubec/Desktop/Projects/Projects/Phaser/phaser_practice/node_modules/phaser/src/physics/impact/SeparateY.js"],"names":["SeparateY","world","top","bottom","weak","nudge","pos","y","size","nudgeX","resTop","strong","vel","bounciness","Math","abs","minBounceVelocity","standing","x","delta","resWeak","collisionMap","trace","gravity","v2","resBottom","module","exports"],"mappings":"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","sourcesContent":["/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2020 Photon Storm Ltd.\r\n * @license      {@link https://opensource.org/licenses/MIT|MIT License}\r\n */\r\n\r\n/**\r\n * [description]\r\n *\r\n * @function Phaser.Physics.Impact.SeparateY\r\n * @since 3.0.0\r\n *\r\n * @param {Phaser.Physics.Impact.World} world - [description]\r\n * @param {Phaser.Physics.Impact.Body} top - [description]\r\n * @param {Phaser.Physics.Impact.Body} bottom - [description]\r\n * @param {Phaser.Physics.Impact.Body} [weak] - [description]\r\n */\r\nvar SeparateY = function (world, top, bottom, weak)\r\n{\r\n    var nudge = (top.pos.y + top.size.y - bottom.pos.y);\r\n    var nudgeX;\r\n    var resTop;\r\n    \r\n    if (weak)\r\n    {\r\n        var strong = (top === weak) ? bottom : top;\r\n\r\n        weak.vel.y = -weak.vel.y * weak.bounciness + strong.vel.y;\r\n        \r\n        // Riding on a platform?\r\n        nudgeX = 0;\r\n\r\n        if (weak === top && Math.abs(weak.vel.y - strong.vel.y) < weak.minBounceVelocity)\r\n        {\r\n            weak.standing = true;\r\n            nudgeX = strong.vel.x * world.delta;\r\n        }\r\n        \r\n        var resWeak = world.collisionMap.trace(weak.pos.x, weak.pos.y, nudgeX, weak === top ? -nudge : nudge, weak.size.x, weak.size.y);\r\n\r\n        weak.pos.y = resWeak.pos.y;\r\n        weak.pos.x = resWeak.pos.x;\r\n    }\r\n    else if (world.gravity && (bottom.standing || top.vel.y > 0))\r\n    {\r\n        resTop = world.collisionMap.trace(top.pos.x, top.pos.y, 0, -(top.pos.y + top.size.y - bottom.pos.y), top.size.x, top.size.y);\r\n\r\n        top.pos.y = resTop.pos.y;\r\n        \r\n        if (top.bounciness > 0 && top.vel.y > top.minBounceVelocity)\r\n        {\r\n            top.vel.y *= -top.bounciness;\r\n        }\r\n        else\r\n        {\r\n            top.standing = true;\r\n            top.vel.y = 0;\r\n        }\r\n    }\r\n    else\r\n    {\r\n        var v2 = (top.vel.y - bottom.vel.y) / 2;\r\n\r\n        top.vel.y = -v2;\r\n        bottom.vel.y = v2;\r\n        \r\n        nudgeX = bottom.vel.x * world.delta;\r\n\r\n        resTop = world.collisionMap.trace(top.pos.x, top.pos.y, nudgeX, -nudge / 2, top.size.x, top.size.y);\r\n\r\n        top.pos.y = resTop.pos.y;\r\n        \r\n        var resBottom = world.collisionMap.trace(bottom.pos.x, bottom.pos.y, 0, nudge / 2, bottom.size.x, bottom.size.y);\r\n\r\n        bottom.pos.y = resBottom.pos.y;\r\n    }\r\n};\r\n\r\nmodule.exports = SeparateY;\r\n"]},"metadata":{},"sourceType":"script"}